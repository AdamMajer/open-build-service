linters:
  LineLength:
    max: 150

  # Apply lint in all partials, but exclude 'breadcrumb_items' partials
  InstanceVariables:
    enabled: true
    file_types: not_breadcrumb_items
    matchers:
      not_breadcrumb_items: \A_(?!breadcrumb_items).*\.haml\z

  RuboCop:
    enabled: true
    # These cops are incredibly noisy when it comes to HAML templates, so we
    # ignore them.
    ignored_cops:
      - Lint/BlockAlignment
      - Lint/EndAlignment
      - Lint/Void
      # It's impossible to fix since new lines aren't taken into account - https://github.com/sds/haml-lint/issues/285
      - Layout/EmptyLineAfterGuardClause
      - Layout/ParameterAlignment
      - Layout/ElseAlignment
      - Layout/EndOfLine
      - Layout/IndentationWidth
      - Layout/TrailingEmptyLines
      - Layout/TrailingWhitespace
      - Layout/HashAlignment
      - Metrics/BlockLength
      - Metrics/BlockNesting
      - Layout/LineLength
      - Naming/FileName
      - Style/FrozenStringLiteralComment
      - Style/IfUnlessModifier
      - Style/Next
      - Style/WhileUntilModifier
    # FIXME: Address offenses in the following views
    exclude:
      - "app/views/webui/monitor/_building.html.haml"
      - "app/views/webui/monitor/_building_table.html.haml"
      - "app/views/webui/monitor/_stats.html.haml"
      - "app/views/webui/package/_commit_item.html.haml"
      - "app/views/webui/package/_file.html.haml"
      - "app/views/webui/package/_fileinfo.html.haml"
      - "app/views/webui/package/_linking_packages.html.haml"
      - "app/views/webui/package/_side_links.html.haml"
      - "app/views/webui/package/side_links/_show_developed_packages.html.haml"
      - "app/views/webui/package/statistics.html.haml"
      - "app/views/webui/packages/job_history/index.html.haml"
      - "app/views/webui/project/_side_links.html.haml"
      - "app/views/webui/project/_tabs.html.haml"
      - "app/views/webui/project/side_links/_incident_project.html.haml"
      - "app/views/webui/project/side_links/_requests.html.haml"
      - "app/views/webui/projects/rebuild_times/show.html.haml"
      - "app/views/webui/projects/status/show.html.haml"
      - "app/views/webui/repositories/state.html.haml"
      - "app/views/webui/request/_issues_table.html.haml"
      - "app/views/webui/staging/projects/_history_elements.html.haml"
      - "app/views/webui/staging/workflows/_problems.html.haml"

exclude:
- 'vendor/bundle/**/*'
# The old staging workflow is still using Bento, so we don't lint it
- 'app/views/webui/theme/bento/**/*'
# Kaminari views were created by its generator, they don't pass lint tests
- 'app/views/webui/kaminari/**/*'
# Everything below is the API, we don't lint it (it's mostly XML anyway)
- 'app/views/about/**/*'
- 'app/views/attribute/**/*'
- 'app/views/attribute_namespace/**/*'
- 'app/views/build/**/*'
- 'app/views/comments/**/*'
- 'app/views/distributions/**/*'
- 'app/views/exception_notifier/**/*'
- 'app/views/group/**/*'
- 'app/views/ichain_notifier/**/*'
- 'app/views/message/**/*'
- 'app/views/models/**/*'
- 'app/views/person/**/*'
- 'app/views/public/**/*'
- 'app/views/request/**/*'
- 'app/views/result/**/*'
- 'app/views/search/**/*'
- 'app/views/shared/**/*'
- 'app/views/source/**/*'
- 'app/views/source_project/**/*'
- 'app/views/statistics/**/*'
- 'app/views/status/**/*'
